## Paging

Open the `Purchases` assignment we did before. We're going to add paging to it. First, change `PurchaseRepository` to extend `PagingAndSortingRepository` instead, and add `Pageable pageable` to the custom method:

```java
public interface PurchaseRepository extends PagingAndSortingRepository<Purchase, Integer> {
    Page<Purchase> findByCategory(Pageable pageable, String category);
}
```

In the controller, add an `Integer page` parameter. It is a boxed integer so it can be optional. 

```java
@Controller
public class PurchasesController {
    ...
    
    @RequestMapping(path = "/", method = RequestMethod.GET)
    public String home(Model model, String category, Integer page) {
        page = (page == null) ? 0 : page;
        PageRequest pr = new PageRequest(page, 10);
        Page<Purchase> p;
        if (category != null) {
            p = purchases.findByCategory(pr, category);
        }
        else {
            p = purchases.findAll(pr);
        }
        model.addAttribute("purchases", p);
        model.addAttribute("nextPage", page+1);
        model.addAttribute("showNext", p.hasNext());
        return "home";
    }
}
```

Then, edit `home.html` to display a "Next" link:

```html
...

{{#showNext}}
<a href="/?page={{nextPage}}">Next</a>
{{/showNext}}
</body>
</html>
```

Now let's make the paging work for the category pages as well. Currently, hitting "Next" after going to a category page will cause it to stop filtering. First, in the controller, pass the category to the template:

```java
@Controller
public class PurchasesController {
    ...
    
    @RequestMapping(path = "/", method = RequestMethod.GET)
    public String home(Model model, String category, Integer page) {
        ...
        
        model.addAttribute("category", category);
        return "home";
    }
}
```

Then edit `home.html` to pass the category into the "Next" link if it isn't null:

```html
...


{{#showNext}}
<a href="/?page={{nextPage}}{{#category}}&category={{.}}{{/category}}">Next</a>
{{/showNext}}
</body>
</html>
```
